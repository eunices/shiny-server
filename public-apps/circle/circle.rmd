---
runtime: shiny
title: "Monte carlo simulation of circle to find value of pi"
output: flexdashboard::flex_dashboard
---


```{r}
knitr::opts_chunk$set(echo=F, message=TRUE, warning=TRUE)
library(ggplot2)
library(DT)
```

```{r}
per_step = 100

rad=1
min=-1
max=min+2*rad

angle = seq(-pi, pi, length = 50)
circle = data.frame(x = sin(angle), y = cos(angle))
```

Sidebar {.sidebar}
=====================================

```{r}
actionButton("add", "Add")
```

```{r}
values = reactiveValues()
values$counter = 0
values$data = data.frame(x=numeric(), y=numeric(), inside=integer())
observeEvent(input$add, { 
    values$counter = values$counter + 1
    x = runif(per_step, min=min, max=max)
    y = runif(per_step, min=min, max=max)
    inside = ifelse(x^2 + y^2 < max^2, 1, 0) 
    values$data = rbind(values$data, data.frame(x=x, y=y, inside=inside))
})

output$data = renderDataTable({values$data})
```

```{r}
renderText({ 
    paste("Counter: ", values$counter*per_step)
})
```


Page 1
=====================================  

```{r}
renderPlot({
    ggplot(values$data, aes(x=x, y=y, color=factor(inside))) + 
        geom_point() +
        theme_minimal() +
        scale_x_continuous(limits=c(min,max)) +
        scale_y_continuous(limits=c(min,max)) +
        geom_polygon(aes(x+max, y+max), data = circle, inherit.aes = F) + 
        guides(color=FALSE)
        
    
}, width = 400, height = 400)
```

Page 2
=====================================  
```{r}
dataTableOutput("data")
```